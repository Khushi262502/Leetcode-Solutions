from collections import deque, defaultdict
class Solution(object):
    def verticalTraversal(self, root):
        if not root:
            return []
        queue = deque([(root,0,0)])
        todo = []
        while queue:
            node , r, c = queue.popleft()
            todo.append((c,r,node.val))
            if node.left:
                queue.append((node.left,r+1,c-1))
            if node.right:
                queue.append((node.right,r+1,c+1))
        todo.sort()

        col_map = defaultdict(list)
        for c,r,v in todo:
            col_map[c].append(v)
        return[col_map[c] for c in sorted(col_map)]
